<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="Javascript music player 2022" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#673AB6" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <title>Music Players</title>
    <style>
      :root{--blue-a:#053160;--blue-b:#031E3C;--yellow-a:#FFE96D;--yellow-b:#FFC80B;--red-a:#ff0000;--red-b:#7d0707;--button-height:64px;--icon-size-w:10vh;--icon-size-h:10vh;--font:Arial,Verdana;--font-size:calc(30px + (100 - 30) * ((100vw - 300px) / (1600 - 300)));--tag-font-size:0.6rem;--h2-size:1.7rem;--speed:0.2s}*{margin:0;padding:0;box-sizing:border-box;-webkit-overflow-scrolling:touch}:active,:focus{-webkit-tap-highlight-color:transparent;outline:0;-ms-touch-action:manipulation;touch-action:manipulation}::-webkit-scrollbar{width:0}::-webkit-scrollbar-thumb{background:var(--blue-b)}body,html{position:relative;display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;height:100%;margin:0;padding:0;background-color:var(--blue-b);font-family:var(--font);overflow:hidden}body{background-color:var(--blue-a);opacity:1;transition:opacity var(--speed) ease-in-out;max-width:1210px}button{display:flex;justify-content:center;align-items:center;background-color:transparent;border:none;width:100%;height:100%;cursor:pointer}button:active .icon,button:active label{transform:scale(1.1)}input{position:absolute;inset:0;cursor:pointer;opacity:0}input[type=file]{max-width:1px;max-height:1px;pointer-events:none;opacity:0;visibility:hidden}.input-background{position:absolute;inset:0;transform-origin:0 0;transform:scaleX(0);background-color:var(--yellow-b);pointer-events:none;transition:none}label{flex:1;width:100%;text-align:center;text-transform:uppercase;font-weight:700;color:var(--yellow-b);pointer-events:none;font-size:var(--font-size);transition:transform calc(var(--speed) * .01) ease-in-out;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 15px}h2{text-transform:uppercase;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 15px;color:var(--yellow-b)}p{color:var(--yellow-b)}ul{position:absolute;inset:0;list-style-type:none;flex:1;background-color:var(--yellow-a);transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out;transform:translateX(100%);opacity:1;overflow-y:scroll}li{width:100%;height:var(--button-height)}#main-container{display:flex;width:100%;height:100%;position:relative;flex-direction:column;flex:1;transform:scale(.9) rotate(5deg);transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out;overflow:hidden}#ui,#ui-sub{flex:1;display:flex;flex-direction:column;transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out}#info{display:flex;place-items:center;max-height:var(--button-height);flex:1;cursor:pointer}#info>button{background-color:var(--blue-a);z-index:1000}#info-content{position:absolute;inset:0;top:var(--button-height);bottom:var(--button-height);background-color:var(--blue-b);transform:translateY(-100%);transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out;z-index:999}.info-container{flex:1;position:relative;display:block;height:100%;padding:10px;flex-direction:column;align-items:flex-start;overflow-y:scroll;transform:translate(100%);opacity:0;transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out}.info-container h2{font-size:var(--h2-size);color:var(--blue-a);padding:0}.info-container p{color:var(--yellow-a);font-size:calc(var(--h2-size)/ 1.5);padding:0;padding-top:5px;padding-bottom:15px;font-weight:100;text-transform:uppercase}#controls{position:relative;display:grid;grid-template-columns:25% 50% 25%;flex:1;transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out}#progress-bar{position:relative;max-height:calc(var(--button-height)/ 2);flex:1;transition:none;transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out}#volume{position:relative;grid-area:volume;flex:1;transition:none;transition:transform var(--speed) ease-in-out,opacity var(--speed) ease-in-out}#menu{position:absolute;inset:0;grid-area:menu;display:flex;flex-direction:column;width:100%;height:100%;pointer-events:none;overflow:hidden}#menu-list-container{flex:1;position:relative;display:flex;transform:translateY(100%);transition:transform var(--speed) ease-in-out;background-color:var(--yellow-a);pointer-events:initial}#menu-breadcrumb{position:relative;display:flex;height:var(--button-height);width:100%;height:0;background-color:var(--blue-a);pointer-events:initial;transform-origin:bottom center;transition:height var(--speed) ease-in-out}#menu-breadcrumb .crumbs-container{justify-content:flex-start;display:grid;flex:1;min-width:60%;height:var(--button-height);grid-template-columns:20% 20% 20% 20% 20%;grid-template-rows:var(--button-height)}#menu-breadcrumb .crumbs-container .icon-button{transform:scale(0);transition:transform var(--speed) cubic-bezier(0,1,1,1.5)}#menu-breadcrumb label{color:var(--yellow-a);text-align:right;font-style:italic;font-size:calc(var(--font-size)/ 2);font-weight:100;line-height:var(--button-height);padding:0;align-items:center;justify-content:flex-end;padding-right:10px}#menu-button{position:relative;z-index:9999;height:var(--button-height);bottom:0;background-color:var(--blue-a);pointer-events:initial}#locker{position:absolute;display:none;align-items:center;justify-content:center;inset:0;z-index:9999;transition:transform var(--speed) ease-in-out;transform:scale(0);background-color:var(--blue-b)}#locker p{position:absolute;bottom:20px}#locker .container{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden}#locker-button{width:var(--button-height);height:var(--button-height);transition:transform var(--speed) cubic-bezier(0,1.2,.8,1.2);cursor:pointer;z-index:9999}#locker-button svg,#locker-target svg{width:var(--button-height);height:var(--button-height)}#locker-button:active{transition:none}#locker-background{position:absolute;inset:0;background-color:var(--blue-b);opacity:.95}#locker-target{position:absolute;width:var(--button-height);height:var(--button-height)}#settings{position:absolute;display:flex;align-items:stretch;justify-content:center;width:100%;height:100%;transition:transform var(--speed) ease-in-out;transform:scale(0);background-color:var(--blue-a);overflow:hidden}#settings ul{position:relative;transform:none;align-self:stretch;opacity:1;background-color:transparent}#settings-button{max-height:var(--speed);flex:1}#settings-container{position:relative;display:none;grid-template-rows:var(--button-height) auto var(--button-height);opacity:0;transition:opacity var(--speed) ease-out;flex:1}#settings-container h2{line-height:var(--button-height);font-size:var(--font-size);color:var(--blue-b)}#splash{position:absolute;inset:0;z-index:9999}#splash .splash-container{position:relative;display:flex;flex-direction:column;width:100%;height:100%;overflow:hidden;transition:transform var(--speed) ease-in}#splash .a,#splash .b{flex:1;height:100px;background-color:var(--blue-b);transition:transform var(--speed) ease-out}#splash svg{position:absolute;top:calc(50% - calc(64px/2));left:calc(50% - calc(64px/2));width:var(--button-height);height:var(--button-height)}.list-item-button{display:flex;justify-content:space-between;flex:1;background-color:transparent}.list-item-button:hover,.list-item-buttonactive:active{background-color:var(--yellow-b)!important}.list-item-button label{flex:none;width:100%;align-items:center;color:var(--blue-a);text-align:left;font-weight:bolder;transform-origin:0 50%;padding:0 15px}.list-item-button .label-container{display:flex;align-items:center;max-width:calc(100% - var(--button-height))}.list-item-button .icons-container{max-width:var(--button-height);justify-self:flex-end}.icon-button{display:flex}.icons-container{display:flex;align-items:center;justify-content:center;flex:1;width:100%;height:100%}.pre-icon{max-width:var(--button-height);max-height:var(--button-height)}.pre-icon svg{max-width:calc(var(--button-height)/ 2);max-height:calc(var(--button-height)/ 2);padding-left:10px}.icon{width:var(--icon-size-w);height:var(--icon-size-h)}.toggle-button{justify-content:space-between}.toggle-button label{text-align:left;display:flex;flex-direction:column}.toggle-button label span{font-size:calc(var(--font-size)/ 2.5);font-weight:100;font-style:italic}.toggle-button .icons-container{max-width:var(--button-height)}.tag{position:absolute;inset:0;transform:translate3d(calc(100% - var(--tag-font-size)),100%,0) rotate(-90deg);transform-origin:top left;font-size:var(--tag-font-size);color:var(--blue-a)}.void{flex:1;max-height:var(--button-height)}.hidden{display:none;visibility:hidden;opacity:0;pointer-events:none}.pulse{animation-name:pulse;animation-duration:calc(var(--speed) * 1.5);animation-iteration-count:infinite}@keyframes pulse{0%{transform:scale(1)}100%{transform:scale(1.17)}}@media (min-width:768px){:root{--button-height:128px}}@media (orientation:landscape){:root{--icon-size-w:8vh;--icon-size-h:8vh}#play-pause-button .icon{height:calc(var(--icon-size-h) + 15%);width:calc(var(--icon-size-w) + 15%)}}@media (orientation:portrait){:root{--icon-size-w:10vw;--icon-size-h:10vw}#play-pause-button .icon{height:calc(var(--icon-size-h) + 30%);width:calc(var(--icon-size-w) + 30%)}}
    </style>
  </head>
  <body>
    <div id="main-container">
      <div id="ui">
        <section id="info">
          <div id="info-content">
            <div class="info-container">
              <h2>Title</h2>
              <p class="title"></p>
              <h2>Type</h2>
              <p class="type"></p>
              <h2>Duration</h2>
              <p class="duration"></p>
            </div>
          </div>
        </section>
        <div id="ui-sub">
          <section id="controls"></section>
          <section id="progress-bar">
            <input id="progress-bar-input" type="range" value="50" />
            <label class="hidden" for="progress-bar-input"
              >Progress Input</label
            >
            <div class="input-background"></div>
          </section>
          <section id="volume">
            <input id="volume-input" type="range" value="50" />
            <label class="hidden" for="volume-input">Volume Input</label>
            <div class="input-background"></div>
            <p class="tag">bp.net@2022</p>
          </section>
        </div>
        <section class="void">
          <input id="files-input" type="file" accept="audio/*" multiple />
        </section>
      </div>
      <section id="menu">
        <div id="menu-list-container"></div>
        <div id="menu-breadcrumb">
          <div class="crumbs-container"></div>
          <label>crumb</label>
        </div>
      </section>
    </div>

    <div id="settings">
      <div id="settings-container">
        <h2>settings</h2>
      </div>
    </div>

    <div id="locker">
      <div class="container">
        <div id="locker-background"></div>
        <p>Drag icon to unlock</p>
      </div>
    </div>

    <div id="splash">
      <div class="splash-container">
        <div class="a"></div>
        <div class="b"></div>
        <svg
          width="100%"
          height="100%"
          viewBox="0 0 64 64"
          fill="var(--yellow-b)"
        >
          <path
            d="M 64,64 H 42 V 45 H 52 V 19 H 21 l 0,45 H -4 V 45 H 10 V 0 H 64 Z"
          />
        </svg>
      </div>
    </div>

    <template id="buttons-template">
      <button class="labeled-button">
        <label></label>
        <div class="icons-container"></div>
      </button>
      <button class="icon-button">
        <div class="icons-container"></div>
      </button>
      <button class="list-item-button">
        <div class="label-container">
          <div class="pre-icon"></div>
          <label></label>
        </div>
        <div class="icons-container"></div>
      </button>
      <button class="menu-button" aria-label="Show Hide Menu"></button>
      <button class="toggle-button" aria-label="toggle">
        <label></label>
        <div class="icons-container"></div>
      </button>
    </template>
    <template id="icons-template">
      <svg
        class="icon-leaf"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path
          d="M 9.5190359,52.000807 29.956285,32.000813 9.5190359,12.000806 21.781385,8.0937692e-4 54.480986,32.000822 21.781385,64.00081 Z"
        />
      </svg>
      <svg
        class="icon-previous"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="m 13.661063,35.044234 v 28.85294 H 0.0040248 V 2.64e-4 H 13.661063 V 29.059417 L 64.002963,0.10366082 V 64.000571 Z"
        />
      </svg>
      <svg class="icon-play" width="100%" height="100%" viewBox="0 0 128 128">
        <path d="M 128,64 0,128 V 0 Z" style="fill: var(--yellow-b)" />
      </svg>
      <svg
        class="icon-pause"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <rect x="0" y="0" width="27" height="64" />
        <rect x="37" y="0" width="27" height="64" />
      </svg>
      <svg
        class="icon-next"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="M 50.338937,28.955766 V 0.102826 h 13.657038 v 63.89691 H 50.338937 V 34.940583 L -0.0029631,63.896339 V -5.70818e-4 Z"
        />
      </svg>
      <svg
        class="icon-menu"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path d="M 64,0 V 26.999998 H 0 V 0 Z" />
        <path d="M 64,37 V 63.999998 H 0 V 37 Z" />
      </svg>
      <svg
        class="icon-cross"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="M 32.001483,21.001758 52.365147,0.0017 64.000277,12.002701 44.606206,32.002864 64.000277,52.00077 52.365147,64.001771 32.001483,43.001712 11.637818,64.001771 5e-4,52.00077 19.394571,32.002864 5e-4,12.002701 11.637818,0.0017 Z"
        />
      </svg>
      <svg
        class="icon-stream"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path
          d="M 46.825,64 H 64 V 0 H 46.825 v 11.361 h 5.814 v 41.278 h -5.814 z"
        />
        <path
          d="M 46.825,64 H 64 V 0 H 46.825 v 11.361 h 5.814 v 41.278 h -5.814 z"
        />
        <path
          d="M 17.175,64 H 0 V 0 h 17.175 v 11.361 h -5.814 v 41.278 h 5.814 z"
        />
        <path
          d="M 33.68596,44.273236 H 44.273236 V 19.726764 H 33.68596 v 8.357382 h 4.229894 v 7.831708 H 33.68596 Z"
        />
        <path
          d="M 30.31404,44.273236 H 19.726764 V 19.726764 H 30.31404 v 8.357382 h -4.229894 v 7.831708 h 4.229894 z"
        />
      </svg>
      <svg
        class="icon-music"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path
          d="M 64,64 H 42 V 45 H 52 V 19 H 21 l 0,45 H -4 V 45 H 10 V 0 H 64 Z"
        />
      </svg>
      <svg
        class="icon-loading"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-b)"
      >
        <rect x="0" y="24" width="16" height="16" />
        <rect x="24" y="24" width="16" height="16" />
        <rect x="48" y="24" width="16" height="16" />
      </svg>
      <svg
        class="icon-open"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <rect x="0" y="24" width="16" height="16" />
        <rect x="24" y="24" width="16" height="16" />
        <rect x="48" y="24" width="16" height="16" />
      </svg>
      <svg
        class="icon-crumb"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <rect x="16" y="16" width="32" height="32" />
      </svg>
      <svg
        class="icon-settings"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path
          d="M 14.985,11.867 V 0 H 3.624 V 11.867 H 0 V 23.228 H 3.624 V 64 H 14.985 V 23.228 h 3.624 V 11.867 Z"
        />
        <path
          d="M 60.376,20.639 V 0 H 49.015 V 20.639 H 45.391 V 32 h 3.624 V 64 H 60.376 V 32 H 64 V 20.639 Z"
        />
        <path
          d="M 37.681,45.474 V 0 H 26.32 V 45.474 H 22.696 V 56.835 H 26.32 V 64 h 11.361 v -7.165 h 3.624 V 45.474 Z"
        />
      </svg>
      <svg
        class="icon-playlist"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path d="M 64,64 H 42.232 V 44.772 H 52.639 V 0 H 64 Z" />
        <path d="M 6.886e-8,11.361 V 0 H 42.231502 v 11.361 z" />
        <path d="M 0,63.999999 V 53.352982 h 29.824222 v 10.647017 z" />
        <path d="m 6.886e-8,38.037491 v -11.361 H 42.231502 v 11.361 z" />
      </svg>
      <svg
        class="icon-lock"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
        style="fill-rule: evenodd; clip-rule: evenodd"
      >
        <path
          d="M 57.228,32 V 0 H 6.772 V 32 H 0 v 32 l 64,0.041 V 32 Z M 18.133,11.361 V 32 H 45.867 V 11.361 Z"
        />
      </svg>
      <svg
        class="icon-unlock"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--blue-a)"
      >
        <path
          d="M 57.228,0 H 6.772 V 32 H 0 V 64.041 H 64 V 32 H 18.133 V 11.361 h 27.734 v 9.755 h 11.361 z"
        />
      </svg>
      <svg
        class="icon-active"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--red-a)"
      >
        <path d="m 16,16 h 32 v 32 H 16 Z" />
      </svg>
      <svg
        class="icon-repeat_all"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="M 36.398,8.115 V -0.006 L 64.001,13.795 36.398,27.597 V 19.476 H 11.362 V 31.994 H 0.001 V 8.115 Z"
        />
        <path
          d="m 27.6027,55.825 v 8.121 L -3e-4,50.145 27.6027,36.343 v 8.121 h 25.036 V 31.946 h 11.361 v 23.879 z"
        />
      </svg>
      <svg
        class="icon-repeat_current"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="M 36.398,8.115 V -0.006 L 64.001,13.795 36.398,27.597 V 19.476 H 11.362 V 31.994 H 0.001 V 8.115 Z"
        />
        <path
          d="m 27.6027,55.825 v 8.121 L -3e-4,50.145 27.6027,36.343 v 8.121 h 25.036 V 31.946 h 11.361 v 23.879 z"
        />
        <path
          d="M 47.901138,42.018248 V 26.552859 h -3.39565 l -4.296302,4.296302 2.720702,2.720703 1.124913,-1.125634 c 0,0 0,9.574018 0,9.574018 z"
        />
      </svg>
      <svg
        class="icon-shuffle"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="m 46.329949,37.552594 -8.77819,8.777097 7.686652,7.686652 -6.274974,6.273882 25.035431,3.709479 -3.709479,-25.035432 -6.273881,6.273882 z M 45.238411,9.9833543 38.963437,3.7083802 63.998868,-0.00109865 60.289389,25.034333 54.015508,18.760451 8.777348,63.999704 -8.4138e-4,55.221514 Z M 26.446268,17.668914 8.777348,-0.00109865 -8.4138e-4,8.7770908 17.668078,26.44601 Z"
        />
      </svg>
      <svg
        class="icon-check"
        width="100%"
        height="100%"
        viewBox="0 0 64 64"
        fill="var(--yellow-b)"
      >
        <path
          d="M 24.203,57.8505 64,18.0525 52.096,6.1495 24.203,34.0425 11.904,21.7435 0,33.6475 Z"
        />
      </svg>
    </template>

    <script type="module">
      class Utils{static SPEED=1e3*Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--speed").replace("s",""));static IS_MOBILE=window.matchMedia("(any-pointer:coarse)").matches;static#t=!1;constructor(){}static init(){this.#t||(this.#t=!0,history.URL=t=>{history.replaceState({},"",t),window.dispatchEvent(new Event("locationchange"))})}static getIcon(t,e=null){const s=[...document.querySelector("#icons-template").content.cloneNode(!0).children].find((e=>`icon-${t}`==`${e.className.baseVal}`));return e?s.setAttribute("class",`icon-${t} ${e} icon`):s.setAttribute("class",`icon-${t} icon`),s}static getButton(t){return[...document.querySelector("#buttons-template").content.cloneNode(!0).children].find((e=>`${t}-button`==`${e.className}`))}static getBrowserPath(){const t=new Proxy(new URLSearchParams(window.location.search),{get:(t,e)=>t.get(e)});return null===t.path||"none"===t.path?[]:t.path.split("/")}static getDataFromPath(t,e){let s=null,i=null;const n=t=>{i=t;for(let a=0;a<t.length;a++){const r=t[a],l=`${r.path}`;if(r.children&&l!==e)i=r,n(r.children);else if(l===e){s={parent:i,item:r};break}}return s};return n(t)}static setStartTouchOrMouseEvent(t,e){this.IS_MOBILE?t.addEventListener("touchstart",(t=>e({x:t.touches[0].clientX,y:t.touches[0].clientY})),{passive:!0}):t.addEventListener("mousedown",(t=>e({x:t.clientX,y:t.clientY})))}static setEndTouchOrMouseEvent(t,e){this.IS_MOBILE?t.ontouchend=t=>{let s,i;t.touches.length?(s=t.touches[0].clientX,i=t.touches[0].clientY):(s=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY),e({x:s,y:i})}:t.onmouseup=t=>{e({x:t.clientX,y:t.clientY})}}static setMoveEvent(t,e){const s=window.innerWidth/2,i=window.innerHeight/2;this.IS_MOBILE?t.ontouchmove=t=>{e({x:t.touches[0].clientX-s,y:t.touches[0].clientY-i})}:t.onmousemove=t=>{e({x:t.clientX-s,y:t.clientY-i})}}static unsetTouchOrMouseEvents(t){this.IS_MOBILE?(t.ontouchstart,t.ontouchend,t.ontouchmove=null):(t.onmousedown,t.onmouseup,t.onmousemove=null)}static Wait(t=this.SPEED){return new Promise((e=>setTimeout((()=>{e(!0)}),t)))}static OpenFiles(t=null){if(!t)throw new Error("Need callback to open files...");let e=[],s=document.querySelector("#files-input");s.onchange=()=>{for(let t=0;t<s.files.length;t++){const i=s.files[t];e.push({id:t.toString(),title:i.name.replace(".mp3",""),url:URL.createObjectURL(i),type:"file",action:"play"})}t(e)},s.click()}static Opacity(t,e){t.style.opacity=e}static TranslateY(t,e){let s={x:0,y:e};return e.includes("%")||(s.y=e+"px"),this.Translate(t,s)}static TranslateX(t,e){let s={x:e,y:0};return e.includes("%")||(s.x=e+"px"),this.Translate(t,s)}static Translate(t,e){return this.#e(t,`translate3D(${e.x},${e.y},0)`)}static Rotate(t,e){return this.#e(t,`rotate3D(0,0,${e}deg)`)}static Scale(t,e){return this.#e(t,`scale3D(${e},${e},1)`)}static#e(t,e){return t.style.transform=e,new Promise((t=>setTimeout((()=>{t("done")}),this.SPEED)))}static Distance(t,e){const s=t.getBoundingClientRect(),i=e.getBoundingClientRect(),n=s.left+s.width/2,a=s.top+s.height/2,r=i.left+i.width/2,l=i.top+i.height/2;return Math.sqrt((l-a)*(l-a)+(r-n)*(r-n))}static PeekY(t,e="0"){const s=i=>{t.length?t.forEach((t=>s(t))):"0"===e?this.Opacity(i,1):this.Opacity(i,0),this.TranslateY(t,e)};s(t)}static PeekX(t,e="0"){return e.includes("-")||e<0?this.Opacity(t,0):this.Opacity(t,1),this.TranslateX(t,e)}static Spin(t,e="0"){return this.#e(t,`scale3D(1,1,1) rotate(${e}deg)`)}static Pop(t){return this.#e(t,"scale3D(1,1,1)")}}Utils.init();class Component{#s;#i=[];animID=null;#n={x:0,y:0};constructor(t){this.#s=t}addEventListener(t,e){this.#s.addEventListener(t,e),this.#i.push({name:t,event:e})}dispatchEvent(t,e){this.#s.dispatchEvent(new CustomEvent(t,e))}removeEventListener(t){let e=[];for(let s=0;s<this.#i.length;s++){const i=this.#i[s];i.name!==t?e.push(i):this.#s.removeEventListener(i.name,i.event)}this.#i=e}async translate(t,e){Utils.Translate(t,e)}set id(t){this.#s.setAttribute("id",t)}get id(){return this.#s.getAttribute("id")}set width(t){this.#s.style.width=`${t}px`}get width(){return this.#s.offsetWidth}set height(t){let e=""+t;e.includes("var")||e.includes("%")||(e=`${t}px`),this.#s.style.height=e}get height(){return this.#s.offsetHeight}get element(){return this.#s}set element(t){this.#s=t}}class Controls extends Component{#a;#r;#l;#o=Controls.States.PAUSED;constructor(){super(document.querySelector("#controls"));const t=this.element;this.#a=new IconButton(["previous"]),this.#a.addEventListener("click",(()=>{t.dispatchEvent(new CustomEvent(Controls.States.ON_ACTION,{detail:{state:Controls.States.PREVIOUS}}))})),t.appendChild(this.#a.element),this.#r=new IconButton(["play","pause","loading","cross"]),this.#r.setFill(3,"var(--red-a)"),this.#r.id="play-pause-button",this.#r.addEventListener("click",(()=>{t.dispatchEvent(new CustomEvent(Controls.States.ON_ACTION,{detail:{state:this.#o}}))})),t.appendChild(this.#r.element),this.#l=new IconButton(["next"]),this.#l.addEventListener("click",(()=>{this.element.dispatchEvent(new CustomEvent(Controls.States.ON_ACTION,{detail:{state:Controls.States.NEXT}}))})),t.appendChild(this.#l.element)}set state(t){switch(this.#o=t,this.#o){case Controls.States.PLAYING:this.#r.toggle(1);break;case Controls.States.PAUSED:this.#r.toggle(0);break;case Controls.States.SEEKING:this.#r.toggle(2);break;case Controls.States.ERROR:this.#r.toggle(3)}}get state(){return this.#o}}Controls.States={ON_ACTION:"controlsastatesonaction",PLAYING:"controlsastatesplaying",PLAY:"controlsastatesplay",PAUSED:"controlsastatespaused",SEEKING:"controlsastatesseeking",ERROR:"controlsastateserror",NEXT:"controlsastatesnext",PREVIOUS:"controlsastatesprevious"};class Info extends Component{#c;#h=!1;#u=null;#d=null;#p=null;constructor(){super(document.querySelector("#info"));Utils.getIcon("cross");this.#c=new LabelButton("music player",Utils.getIcon("cross")),this.#d=this.element.querySelector("#info-content"),this.#p=this.element.querySelector(".info-container"),this.element.appendChild(this.#c.element),this.#c.addEventListener("click",(()=>this.#h?this.close():this.open()))}async open(){this.#h||(this.#h=this.#c.iconed=!0,this.element.dispatchEvent(new CustomEvent(Info.States.ON_ACTION,{detail:Info.States.OPENING})),await Utils.TranslateY(this.#d,"0"),Utils.TranslateX(this.#p,"0"),Utils.Opacity(this.#p,1))}async close(){this.#h&&(this.#h=this.#c.iconed=!1,this.#p.style.display="none",await Utils.TranslateY(this.#d,"-100%"),this.#p.style.display="block",Utils.TranslateX(this.#p,"100%"),Utils.Opacity(this.#p,0),this.element.dispatchEvent(new CustomEvent(Info.States.ON_ACTION,{detail:Info.States.CLOSING})))}setupLayout(t){this.#c.text=t.title,this.#p.querySelector(".title").innerText=t.title;const e=this.#p.querySelector(".duration");"file"!==t.type?e.innerText="∞":e.innerText=`${parseInt(t.duration/60%60)}:${parseInt(t.duration%60)}`,this.#p.querySelector(".type").innerText=t.type}update(t,e=null){switch(this.#u=e,this.dimmed=!1,t){case Info.States.DISABLED:this.dimmed=!0;break;case Info.States.ERROR:this.#c.error=!0}e&&this.setupLayout(e)}set dimmed(t=!1){this.#c.dimmed=t}get dimmed(){return this.#c.dimmed}set data(t){this.#u=t}get data(){return this.#u}get isOpened(){return this.#h}}Info.States={ENABLED:"infostatesenabled",DISABLED:"infostatesdisabled",ERROR:"infostateserror",ON_ACTION:"infostatesonaction",OPENING:"infostatesopening",CLOSING:"infostatesclosing"};class List extends Component{#m;#y=[];currentItem=null;constructor(t=null,e=null){if(super(),!t)throw new Error("List missing data! Please add data to list");this.#m=t,this.build(t),this.highlightItem(e)}build(t){this.element=document.createElement("ul");for(let e=0;e<t.children.length;e++){const s=document.createElement("li"),i=new ListButton(t.children[e]);i.addEventListener("click",(()=>{this.currentItem=i,this.dispatchEvent(List.CLICK,{detail:i.data})})),s.appendChild(i.element),this.element.appendChild(s),this.#y.push(i)}}set activated(t){t?this.currentItem.setIcon("active","pulse"):this.currentItem.icon=[]}get activated(){return this.currentItem.icon}highlightItem(t=null){null!==t&&this.#y.forEach((e=>{e.highlight(!1),t===e.data.title&&(this.currentItem=e,e.highlight(!0))}))}set data(t){this.#m=t}get data(){return this.#m}get children(){return this.#y}async show(t="0",e=1){return Utils.Opacity(this.element,e),Utils.TranslateX(this.element,t)}async hide(t="100%",e=0){return Utils.Opacity(this.element,e),Utils.TranslateX(this.element,t)}async peekX(t="0"){return Utils.PeekX(this.element,t)}static get CLICK(){return"listclick"}}class Locker extends Component{#g;#E;#I=window.innerWidth/2.5;constructor(){super(document.querySelector("#locker"));const t=this.element.querySelector(".container");this.#g=new IconButton(["lock","unlock"],"locker-button"),this.#g.setFill(0,"var(--yellow-b)"),this.#g.setFill(1,"var(--yellow-b)"),t.appendChild(this.#g.element),this.#E=new IconButton(["lock","unlock"],"locker-target"),t.appendChild(this.#E.element),Utils.setStartTouchOrMouseEvent(this.#g.element,(()=>{this.startDrag()}))}startDrag(){Utils.setEndTouchOrMouseEvent(document,(t=>this.endDrag(t))),Utils.setMoveEvent(document,(t=>{Utils.Distance(this.#g.element,this.#E.element)>=this.#I?(this.#g.toggle(1),this.#E.toggle(1)):(this.#g.toggle(0),this.#E.toggle(0)),Utils.Translate(this.#g.element,{x:`${t.x}px`,y:`${t.y}px`})}))}endDrag(){Utils.unsetTouchOrMouseEvents(document),Utils.Distance(this.#g.element,this.#E.element)>=this.#I?(this.element.dispatchEvent(new CustomEvent(Locker.ACTION,{detail:{type:Locker.Actions.UNLOCKED}})),this.hide()):Utils.Translate(this.#g.element,{x:0,y:0}),this.#g.toggle(0)}show(){this.element.dispatchEvent(new CustomEvent(Locker.ACTION,{detail:{type:Locker.Actions.OPENING}})),this.element.style.display="flex",requestAnimationFrame((()=>this.element.style.transform="scale(1)"))}async hide(){this.element.dispatchEvent(new CustomEvent(Locker.ACTION,{detail:{type:Locker.Actions.CLOSING}})),this.element.style.transform="scale(0)",await Utils.Wait(),Utils.Translate(this.#g.element,{x:0,y:0}),this.element.style.display="none"}static get ACTION(){return"lockeraction"}static get Actions(){return{UNLOCKED:"lockeractionsunlocked",OPENING:"lockeractionsopening",CLOSING:"lockeractionsclosing"}}}class Menu extends Component{#b;#C;#v;#f=[];#T=null;#S=[];#L=!1;isOpened=!1;#O;constructor(t){super(document.querySelector("#menu")),this.#b=t,this.#O=new Breadcrumb("menu-breadcrumb"),this.#O.addEventListener(Breadcrumb.GO_TO,(t=>this.gotoList(t.detail))),this.#C=new IconButton(["menu","cross"],"menu-button"),this.#C.addEventListener("click",(()=>{this.isOpened?this.close():this.open()})),this.element.appendChild(this.#C.element),this.#v=this.element.querySelector("#menu-list-container")}async open(){this.buildMenu(),this.dispatchEvent(Menu.ACTION,{detail:{action:"opening"}}),this.#C.toggle(1),await Utils.TranslateY(this.#v,"0"),this.#L?this.#T.show():this.#f.forEach((t=>t.show())),this.isOpened=!0}async close(){this.clearMenu(),this.#O.hide(),this.dispatchEvent(Menu.ACTION,{detail:{action:"closing"}}),this.#C.toggle(0),await Utils.TranslateY(this.#v,"100%"),this.isOpened=!1}buildMenu(){this.#S=[];const t=Utils.getBrowserPath();if(t&&(this.#S=t),this.addList(this.#b[0],!1),this.#L){let t=[];const e=s=>{for(let i=0;i<this.#S.length;i++)for(let n=0;n<s.length;n++)if(s[n].title===this.#S[i]){const i=s[n];t.push(i),i.children&&e(i.children);break}};e(this.#b[0].children),t.forEach((t=>{t.children&&this.addList(t,!1)}))}}clearMenu(){this.#f.forEach((t=>this.#v.removeChild(t.element))),this.#f=[],this.#T=null}addList(t,e=!0){this.#T&&this.#T.peekX("-30%",0);const s=new List(t,this.#S[this.#f.length]);s.addEventListener(List.CLICK,(t=>{const e=t.detail;e.children?this.addList(e):e.action&&this.dispatchEvent(Menu.ACTION,{detail:{action:e.action,listData:s.data,currentItem:e}})})),this.#v.appendChild(s.element),this.#f.push(s),this.#T=s,this.#O.update(this.#T.data),this.#T.currentItem&&this.#L&&(this.#T.currentItem.data.children||(s.activated=!0)),e&&requestAnimationFrame((()=>s.show())),this.dispatchEvent(Menu.ACTION,{detail:{action:"list_added"}})}async gotoList(t=0){let e=[];for(let s=this.#f.length-1;s>t;s--)e.push(this.#f[s]);this.#T=this.#f[t],this.#T.peekX("0"),e.forEach((t=>t.hide())),this.#f.length-e.length>1?this.#O.show():this.#O.hide(),await Utils.Wait(),e.forEach((t=>this.removeList(t)))}removeList(t){this.#v.removeChild(t.element),this.#f=this.#f.filter((e=>e!==t)),this.#f.length>1?this.#O.show():this.#O.hide(),this.dispatchEvent(Menu.ACTION,{detail:{action:"list_removed"}})}static get ACTION(){return"menuaction"}set activated(t){this.#L=t}get activated(){return this.#L}get currentData(){return this.#T.currentItem.data}}class Player{#A;#w;#k=[];#N=0;#P=Player.PLAY_MODE.REPEAT_ALL;constructor(t,e=null){this.#k=t,e&&(this.#N=t.findIndex((t=>t.id===e.id))),this.#A=new Audio,this.#w=Player.Actions.PAUSED,this.#A.onended=()=>{switch(this.#P){case Player.PLAY_MODE.REPEAT_ALL:this.#N<this.#k.length-1&&this.next();break;case Player.PLAY_MODE.REPEAT_CURRENT:this.play(this.#k,this.#N);case Player.PLAY_MODE.SHUFFLE:}this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.ENDED}}))}}async play(t=null,e=null){null!==e&&(this.#N=e),null!==t&&(this.#k=t),this.#k[this.#N].url!==this.#A.src&&(this.#A.src=this.#k[this.#N].url),this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.LOADING}}));try{await this.#A.play(),this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.PLAYING}})),Number.isFinite(this.duration)?this.#A.ontimeupdate=()=>{this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.TIME_UPDATE,time:this.currentTime/this.duration}}))}:this.#A.ontimeupdate=null}catch(t){if(!this.#A.error)return;let e;switch(this.#A.error.code){case MediaError.MEDIA_ERR_ABORTED:e="Aborted!";break;case MediaError.MEDIA_ERR_NETWORK:e="No Network!";break;case MediaError.MEDIA_ERR_DECODE:e="Error decoding!";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:e="Not Suported/Found!";break;default:e="UnknownError"}this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.ERROR,error:t,message:e}}))}}pause(){this.#A.pause(),this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.PAUSED}}))}next(){this.#k.length<=1&&this.#P===Player.PLAY_MODE.REPEAT_ALL||(this.#N++,this.#N>=this.#k.length&&(this.#N=0),this.play())}previous(){this.#k.length<=1||(this.#N--,this.#N<0&&(this.#N=this.#k.length-1),this.play())}addEventListener(t,e){this.#A.addEventListener(t,e)}set volume(t){this.#A.volume=t,this.#A.dispatchEvent(new CustomEvent(Player.ACTION,{detail:{type:Player.Actions.VOLUME}}))}get volume(){return this.#A.volume}get playmode(){return this.#P}set playmode(t){this.#P=t}get state(){this.#w}get duration(){return this.#A.duration}set currentTime(t){this.currentTrack&&"stream"!==this.currentTrack.type&&(this.#A.currentTime=t*this.#A.duration)}get currentTime(){return Number.isFinite(this.duration)?this.#A.currentTime:-1}get currentTrack(){return this.#k.length?{...this.#k[this.#N],duration:this.duration,currentTime:this.currentTime}:null}get isPlaying(){return!this.#A.paused}}Player.ACTION="playeraction",Player.Actions={LOADING:"playeractionsloading",PLAYING:"playeractionsplaying",PAUSED:"playeractionspaused",ENDED:"playeractionsended",VOLUME:"playeractionsvolume",TIME_UPDATE:"playeractionstimeupdate",ERROR:"playeractionserror"},Player.PLAY_MODE={REPEAT_ALL:"repeat_all",REPEAT_CURRENT:"repeat_current",SHUFFLE:"shuffle"};class Settings extends Component{#D=null;#x=null;#B;constructor(t=null){super(document.querySelector("#settings")),this.#x=this.element.querySelector("#settings-container"),this.#D=t,this.buildView()}buildView(){const t=document.createElement("ul");let e=document.createElement("li");const s=this.#D.find((t=>"playmode"===t.type));this.#B=new ToggleButton(s.name,s.value,["repeat_all","repeat_current","shuffle"]),this.#B.addEventListener(ToggleButton.CLICK,(t=>{this.#D[0].value=t.detail.value,this.#U(0)})),e.appendChild(this.#B.element),t.appendChild(e);const i=new IconButton(["check"],"settings-close-button");i.addEventListener("click",(()=>{this.hide()})),this.#x.appendChild(t),this.#x.appendChild(i.element)}#U(t=0){this.lock(this.#D[t].type),this.dispatchEvent(Settings.ACTION,{detail:{type:Settings.Actions.HAS_CHANGED,data:this.#D[t]}})}lock(t){this.#R(t,!1)}#R(t,e){if("playmode"===t)this.#B.setEnabled(e,this.#D[0].value)}unlock(t){this.#R(t,!0)}async show(){this.element.dispatchEvent(new CustomEvent(Settings.ACTION,{detail:{type:Settings.Actions.OPENING}})),this.element.style.display="flex",requestAnimationFrame((()=>this.element.style.transform="scale(1)")),this.#x.style.display="grid",await Utils.Wait(),requestAnimationFrame((()=>Utils.Opacity(this.#x,1)))}async hide(){this.element.dispatchEvent(new CustomEvent(Settings.ACTION,{detail:{type:Settings.Actions.CLOSING}})),this.#x.style.display="none",Utils.Opacity(this.#x,0),this.element.style.transform="scale(0)",await Utils.Wait(),this.element.style.display="none"}static get ACTION(){return"settingsaction"}static get Actions(){return{OPENING:"settingsctionsopening",CLOSING:"settingsactionsclosing",HAS_CHANGED:"settingsactionshaschanged"}}}class Button extends Component{#M;#_=!0;constructor(t,e=null){super(t),this.#M=e}addEventListener(t,e){super.addEventListener(t,e)}highlight(t=!1){this.element.style.backgroundColor=""+(t?"var(--yellow-b)":"transparent")}setEnabled(t){this.enabled=t}get enabled(){return this.#_}set enabled(t){let e;this.#_=t,e=this.#_?"initial":"none",this.element.style.pointerEvents=e}set data(t){this.#M=t}get data(){return this.#M}}class IconButton extends Button{#q;#G=[];#Y=!1;#$=0;constructor(t,e=null){super(Utils.getButton("icon")),this.#q=this.element.querySelector(".icons-container");for(let e=0;e<t.length;e++){const s=Utils.getIcon(t[e]);this.#q.appendChild(s),this.#G.push(s)}this.#Y=this.#q.children.length>1,this.#Y&&this.toggle(this.#$),e&&(this.id=e)}toggle(t=0){for(let e=0;e<this.#G.length;e++){const s=this.#G[e];s.style.display="none",e===t&&(s.style.display="initial")}}setFill(t=0,e){this.#G[t].style.fill=e}set state(t){this.#$=t,this.toggle(this.#$)}get state(){return this.#$}}class LabelButton extends Button{#X;#g;constructor(t="...",e=null){super(Utils.getButton("labeled")),this.#X=this.element.querySelector("label"),this.#g=this.element.querySelector(".icons-container"),e&&(this.#g.appendChild(e),this.#g.style.display="none"),this.text=t}addEventListener(t,e){super.addEventListener(t,(t=>e(t)))}set error(t){this.#X.style.color=t?"var(--red-a)":"var(--red-b)"}set dimmed(t){this.#X.style.color=t?"var(--blue-b)":"var(--yellow-b)"}get dimmed(){return this.enabled}set iconed(t){t?(this.#X.style.display="none",this.#g.style.display="flex"):(this.#X.style.display="initial",this.#g.style.display="none")}get iconed(){return"initial"===this.#g.style.display}get text(){return tthis.#X.innerText}set text(t){this.#X.innerText=t}}class ListButton extends Button{#F;#V;#q;constructor(t){super(Utils.getButton("list-item"),t),this.#F=this.element.querySelector(".label-container"),this.#V=this.element.querySelector("label"),this.#q=this.element.querySelector(".icons-container"),t.icon?this.icon=[t.icon]:t.children?this.icon=["leaf"]:this.#F.style.maxWidth="100%",this.label=t.title}setIcon(t,e=null){this.#q.append(Utils.getIcon(t,e)),this.#F.style.maxWidth="calc(100% - var(--button-height))"}set icon(t){if(t.length)for(let e=0;e<t.length;e++)this.#q.append(Utils.getIcon(t[e]));else this.#q.innerHtml=""}get icon(){return this.#q.children}set label(t){this.#V.innerText=t}get label(){return this.#V.innerText}}class ToggleButton extends Button{#H;#W;#j=0;#K;constructor(t="",e="",s=[]){super(Utils.getButton("toggle")),this.#K=t,this.#H=this.element.querySelector(".icons-container"),this.#W=this.element.querySelector("label"),this.#W.innerHTML=`${this.#K}<span>${e}</span>`;for(let t=0;t<s.length;t++){const e=Utils.getIcon(s[t]);t!==this.#j&&(e.style.display="none"),this.#H.appendChild(e)}const i=this.#H.children;this.addEventListener("click",(()=>{this.#j++,this.#j>=i.length&&(this.#j=0);for(let t=0;t<i.length;t++)t!==this.#j?i[t].style.display="none":i[t].style.display="initial";this.dispatchEvent(ToggleButton.CLICK,{detail:{index:this.#j,value:s[this.#j]}})}))}setEnabled(t,e=""){let s;super.setEnabled(t),this.enabled?(s=1,this.#W.innerHTML=`${this.#K}<span>${e}</span>`):(s=.7,this.#W.innerHTML=`${this.#K}<span>...</span>`),this.element.style.opacity=s}}ToggleButton.CLICK="togglebuttonclick";class Breadcrumb extends Component{#Z=[];#q;#z;#J=!1;#Q=5;constructor(t){super(document.querySelector(`#${t}`)),this.#q=this.element.querySelector(".crumbs-container"),this.#z=this.element.querySelector("label"),this.height=0}addCrumb(t="crumb"){const e=new IconButton(["crumb"]),s=this.#Z.length;this.#q.appendChild(e.element),this.#Z.push({elem:e,title:t}),e.addEventListener("click",(()=>{this.dispatchEvent(Breadcrumb.GO_TO,{detail:s}),this.removeCrumb(s)})),Utils.Pop(e.element),this.title=t}removeCrumb(t=-1){if(0!==t){for(let e=this.#Z.length-1;e>0&&(this.#q.removeChild(this.#Z[e].elem.element),this.#Z.pop(),t!==e);e--);this.title=this.#Z[this.#Z.length-1].title}}show(){this.#J||(this.height="var(--button-height)",this.#J=!0)}hide(){this.#J&&(this.#Z.forEach((t=>this.#q.removeChild(t.elem.element))),this.#Z=[],this.height=0,this.title="",this.#J=!1)}update(t){if(!t.path||!t.children)return;t.id.split(".").map((t=>+t+0)).length>this.#Z.length&&(this.show(),this.addCrumb(t.title))}get length(){return this.#Z.length}set title(t=""){this.#z.innerText=t}get title(){return this.#z.innerText}static get GO_TO(){return"breadcrumbactionsgoto"}}class RangeSlider extends Component{#tt;#et;#st=!1;#it=0;#nt=null;constructor(t){super(document.querySelector(t));const e=this.element.querySelector("input");this.#tt=this.element.querySelector(".input-background"),e.oninput=()=>{this.#et=e.value,this.element.dispatchEvent(new CustomEvent(RangeSlider.Actions.ON_INPUT,{detail:this.value}))},this.#et=e.value}async hide(){this.#it=0,this.#nt&&(clearInterval(this.#nt),this.#nt=null),Utils.Opacity(this.element,0),this.#nt=setInterval((()=>{this.element.style.visibility="hidden",this.#tt.style.transform="scaleX(0)"}),Utils.SPEED)}show(){this.#nt&&(clearInterval(this.#nt),this.#nt=null),this.element.style.visibility="initial",Utils.Opacity(this.element,1)}animateBackground(){this.#st&&(this.#it+=2,this.element.style.backgroundPosition=`${this.#it}px 0px`,this.#it>=this.element.width&&(this.#it=0))}set animated(t=!1){this.#st=t,this.#st?this.element.style.backgroundImage='url("loading_bar.svg")':this.element.style.backgroundImage=null}get animated(){return this.#st}set value(t){this.#et=t,this.#tt.style.transform=`scaleX(${100*this.#et}%)`}get value(){return this.#et/100}}RangeSlider.Actions={ON_INPUT:"rangeslideractionsoninput"};class Splash{constructor(){}async doSplash(t){const e=document.querySelector("#splash"),s=e.querySelectorAll(".a, .b"),i=e.querySelector(".splash-container"),n=i.querySelector("svg");i.removeChild(n),Utils.Spin(t),s[0].style.transform="translateY(-100%)",s[1].style.transform="translateY(100%)",await Utils.Wait(),document.body.removeChild(e)}}import{initializeApp as t}from"https://www.gstatic.com/firebasejs/9.8.3/firebase-app.js";import{getFirestore as e,collection as s,getDocs as i,updateDoc as n,doc as a,getDoc as r}from"https://www.gstatic.com/firebasejs/9.8.3/firebase-firestore.js";import{getStorage as l,ref as o,listAll as c,getDownloadURL as h}from"https://www.gstatic.com/firebasejs/9.8.3/firebase-storage.js";t({apiKey:"AIzaSyDfWfH1NKuOw0LV8zsrs1qMZb9GMwTasNY",authDomain:"music-player-9d063.firebaseapp.com",projectId:"music-player-9d063",storageBucket:"music-player-9d063.appspot.com",messagingSenderId:"330573243041",appId:"1:330573243041:web:fd1c00053e3739f041c6e0"});export const getAllData=async t=>{let e=[{title:t,children:[]}];const s=await getDB("streams"),i=e[0].children;return i.push({id:"0",title:"streams",path:"streams",children:s.children}),i.push({id:"1",title:"music",path:"music",children:await getFolder("music","1")}),i.push({id:"2",title:"playlists",path:"playlists",children:[]}),i.push({id:"3",title:"open",path:"open",icon:"open",action:"open"}),i.push({id:"4",title:"settings",path:"settings",icon:"settings",action:"settings"}),i.push({id:"5",title:"lock",path:"lock",icon:"lock",action:"lock"}),e};export const getDB=async t=>{const n=e();let a=null;return(await i(s(n,t))).forEach((t=>a=t.data())),a};export const updateDB=async(t,r)=>{const l=e();let o=null;(await i(s(l,t))).forEach((t=>o=t.id));const c=a(l,t,o);return await n(c,{data:[r]}),r.type};export const getFolder=async(t,e="0")=>{try{const s=await l(),i=o(s,t),n=await c(i);if(!n.prefixes.length)return[];const a=async(e,i=[],n="0")=>{for(let r=0;r<e.length;r++){const l=e[r],u=await c(l),d=`${n}.${r}`;if(u.prefixes.length){let t=await a(u.prefixes,[],d);i.push({id:d,title:l.name,path:l.fullPath,children:t})}else if(u.items.length){let e=[];for(let i=0;i<u.items.length;i++){const n=u.items[i],a=await h(o(s,n.fullPath));e.push({id:`${d}.${i})`,title:n.name,path:n.fullPath,url:a,type:t,action:"play"})}i.push({id:d,title:l.name,path:l.fullPath,children:e})}}return i};return await a(n.prefixes,[],e)}catch(t){}};const u=document.querySelector("#main-container"),d=document.querySelector("#ui"),p=d.querySelector("#ui-sub");let m=!1;window.onload=async()=>{document.body.style.opacity=1,"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")};const y=await fetch("data.json"),g=await y.json(),E=await fetch("settings.json"),I=await E.json();(async()=>{m||(m=!0,await(new Splash).doSplash(u))})();const b=new Info;b.addEventListener(Info.States.ON_ACTION,(t=>{switch(t.detail){case Info.States.OPENING:Utils.PeekY(p,"5%");break;case Info.States.CLOSING:Utils.PeekY(p,"0")}}));const C=new Controls;C.addEventListener(Controls.States.ON_ACTION,(async t=>{switch(t.detail.state){case Controls.States.PREVIOUS:k.previous();break;case Controls.States.PLAYING:k.pause();break;case Controls.States.PAUSED:if(!T.isOpened&&!k.currentTrack){T.open();break}await k.play();break;case Controls.States.NEXT:k.next()}}));const v=new RangeSlider("#progress-bar");v.addEventListener(RangeSlider.Actions.ON_INPUT,(t=>{k.duration!==Number.POSITIVE_INFINITY&&(k.currentTime=t.detail)}));const f=new RangeSlider("#volume");f.addEventListener(RangeSlider.Actions.ON_INPUT,(()=>{k.volume=f.value}));const T=new Menu(g);T.addEventListener(Menu.ACTION,(async t=>{switch(t.detail.action){case"opening":Utils.PeekY(d,"-10%"),b.isOpened&&b.close();break;case"play":T.close();const e=t.detail,s=e.listData.children;k.play(s,s.findIndex((t=>t.id===e.currentItem.id)));break;case"closing":Utils.PeekY(d);break;case"lock":T.close(),S.show();break;case"settings":L.show();break;case"open":Utils.OpenFiles((t=>{t.length&&(k.play(t,0),T.close())}))}}));const S=new Locker;S.addEventListener(Locker.ACTION,(t=>{switch(t.detail.type){case Locker.Actions.OPENING:Utils.Scale(u,"0.5");break;case Locker.Actions.CLOSING:Utils.Scale(u,"1.0")}}));const L=new Settings(I[0].data);L.addEventListener(Settings.ACTION,(async t=>{switch(t.detail.type){case Settings.Actions.HAS_CHANGED:const e=await updateDB("settings",t.detail.data);L.unlock(e),(t=>{switch(t.type){case"playmode":case"theme":k.playmode=t.value}})(t.detail.data);break;case Settings.Actions.OPENING:Utils.Scale(u,"0.5");break;case Settings.Actions.CLOSING:Utils.Scale(u,"1")}}));const O=Utils.getBrowserPath();let A=[],w=null;if(O){let t=Utils.getDataFromPath(g,O.join("/"));t&&(A=t.parent,w=t.item)}const k=new Player(A,w);k.addEventListener(Player.ACTION,(t=>{switch(t.detail.type){case Player.Actions.LOADING:C.state=Controls.States.SEEKING,b.update(Info.States.DISABLED,k.currentTrack);break;case Player.Actions.PLAYING:C.state=Controls.States.PLAYING,b.update(Info.States.ENABLED,k.currentTrack);let e="?path=none";"file"!==k.currentTrack.type&&(e=`?path=${k.currentTrack.path}`),history.URL(e),Number.isFinite(k.duration)?(v.animated=!0,v.show()):(v.animated=!1,v.hide()),T.activated=!0;break;case Player.Actions.ENDED:C.state=Controls.States.PAUSED;break;case Player.Actions.PAUSED:b.update(Info.States.DISABLED,{...k.currentTrack,duration:k.duration,currentTime:k.currentTime}),C.state=Controls.States.PAUSED,T.activated=!1;break;case Player.Actions.VOLUME:f.value=k.volume;break;case Player.Actions.TIME_UPDATE:v.value=t.detail.time,v.animateBackground();break;case Player.Actions.ERROR:b.update(Info.States.ERROR,k.currentTrack),C.state=Controls.States.ERROR,b.state=Info.States.ERROR}})),k.volume=f.value,k.currentTrack?b.title=k.currentTrack.title:b.title="Music Player";
    </script>
  </body>
</html>
